# Get the dataset
```
chmod +x ./get_data.sh
./get_data.sh
```
# Training time and minimun requirement
Training the model requires a GPU with a minimum of 1GB of memory. Please check the minimum requirements on PyTorch's website [here](https://pytorch.org/get-started/locally/). The time needed to train the model using a single dataset ranges from 1 minute for YAP1 (our smallest dataset) to 13 minutes for BF520 (our largest dataset). On average, it takes approximately 8 minutes to generate the esm vectors for one dataset, although generating vectors for all datasets took 5 hours. Pretraining the model on the fitness dataset took around 4 minutes, while pretraining it on all available datasets took 80 minutes

# Generate ESM vectors

```
usage: generate_vectors.py [-h] [-s S] [-n N] [-f F] [-m M] [-gpu GPU]

Generate ESM vectors from protein sequences and mutation data

optional arguments:
  -h, --help  show this help message and exit
  -s S        The file containing the protein sequences. (default: None)
  -n N        The name of the protein sequence in the file. (default: SUMO1_HUMAN_Roth2017)
  -f F        The mapping file. (default: None)
  -m M        The file containing the mutations, the position of the mutations and the output values. (default: None)
  -gpu GPU    The device to use for the esm model. (default: 0)

```
### Example

```
python generate_vectors.py -s data/sequence_v2.txt -f data/dataset_to_seq.xlsx -m data/NIHMS1014772-supplement-Supplemental_2.xlsx
```

# Train the model

```
usage: rep2mut_v2.py train [-h] [-epoch EPOCH] [-lr1 LR1] [-lr2 LR2] [-batch BATCH] [-save SAVE]

optional arguments:
  -d D          The name of the datasetset to train/test. (default: None)
  -gpu GPU      The device to use to train the model. (default: 0)
  -p P          the file containing the vectors generated by generate_vectors.py (default: ./vectors.p)
  -epoch EPOCH  The number of epochs.
  -lr1 LR1      The learning rate of the task specific layer.
  -lr2 LR2      The learning rate of the shared task.
  -batch BATCH  The batch size.
  -save SAVE    The save folder.
```

### Example

```
python rep2mut_v2.py train -d SUMO1_HUMAN_Roth2017 -save save.pt
```

# Test the model
```
  -d D        The name of the datasetset to train/test. (default: None)
  -gpu GPU    The device to use to train the model. (default: 0)
  -p P        the file containing the vectors generated by generate_vectors.py (default: ./vectors.p)
  -m M        The model's parameters. (default: ./Rep2Mut.p)
  -save SAVE  The save folder.
```
### Example

```
python rep2mut_v2.py test -m ./vectors.p
```
